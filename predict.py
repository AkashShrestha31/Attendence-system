import tensorflow as tf
from scipy import ndimage
import scipy.misc
import numpy as np
import cv2
from forward_propogation import *
import matplotlib.pyplot as plt
W1=[[[[1.07618213e+00,2.18055099e-02,9.70983446e-01,-2.66516328e-01,-2.40551725e-01,-4.24594462e-01,3.50526631e-01,8.29601064e-02],
[8.05665433e-01,4.88148183e-01,5.33849835e-01,2.93115258e-01,8.25669914e-02,1.25754327e-01,3.33052456e-01,-4.96533215e-02],
[7.90145755e-01,2.62077391e-01,7.97722459e-01,1.03999066e+00,-1.30007550e-01,4.99657571e-01,-9.52216759e-02,-1.52718931e-01]],

[[4.72376972e-01,-9.47628617e-01,6.52038038e-01,-2.89343745e-01,-2.18277752e-01,-5.75162768e-01,1.60602868e-01,-1.50472820e-01],
[4.81230766e-01,-5.83596945e-01,6.79514229e-01,1.05849020e-01, -9.98243913e-02,-4.90625948e-01,3.26705933e-01,2.67401673e-02],
[3.07655424e-01,-8.01984847e-01,5.07045686e-01,9.10392165e-01, 2.02204764e-01,-4.77802753e-02,-1.54082909e-01,-2.50465482e-01]],

[[7.82127261e-01,-8.40467215e-01,3.74780864e-01,-4.99839216e-01, -7.45485444e-03,-2.89408565e-01,8.30426365e-02,-1.74834132e-01],
[1.69253349e-01,-1.37703076e-01,2.93208808e-01,5.75649031e-02,-6.16730824e-02,-4.00484592e-01,5.37219226e-01,-1.65758044e-01],
[2.95676112e-01,-7.09190607e-01,-5.13576828e-02,8.42022777e-01, 1.74301304e-02,-7.74025619e-02,2.38622546e-01,-1.14604197e-01]],

[[9.55310822e-01,-1.04703510e+00,2.18063980e-01,-7.20998883e-01,-8.83565918e-02,4.26961601e-01,1.78030938e-01,-1.15688905e-01],
[6.39496565e-01,-7.05494106e-01,-6.06648564e-01,-4.86616790e-01,-9.29075107e-02,4.07389373e-01,3.95605236e-01,-1.17174432e-01],
[4.70516145e-01,-1.19389725e+00,-1.36492598e+00,8.89997363e-01, 3.16167437e-02,4.74483132e-01,4.09884810e-01,8.07899907e-02]]],


[[[1.86020717e-01,6.17695451e-01,7.44086981e-01,-1.66734502e-01, 5.27270213e-02,-7.94527233e-01,3.54276508e-01,-8.53854343e-02],
[4.73142445e-01,7.77091265e-01,4.61812288e-01,1.38869405e-01,-1.93773046e-01,-3.83309513e-01,2.61732161e-01,-1.95903391e-01],
[4.18129176e-01,5.80536008e-01,3.76445293e-01,6.95337772e-01,-8.25387686e-02,3.60784262e-01,-1.95048198e-01,-1.86886355e-01]],

[[2.16730148e-01,-7.17329904e-02,2.71649897e-01,-1.05188102e-01, 5.17592095e-02,-4.96650994e-01,-2.86466014e-02,1.32600646e-02],
[1.39448985e-01,1.33460417e-01,-2.45655477e-01,1.40882879e-01, 9.07316282e-02,-4.83222932e-01,2.73296284e-03,-2.76260059e-02],
[3.51513565e-01,-2.64742166e-01,-5.96393108e-01,8.55379581e-01, -1.43025696e-01,-1.36775136e-01,-2.18913674e-01,9.22106802e-02]],

[[1.04594633e-01,-1.52444631e-01,-1.96333528e-01,-4.25507516e-01,-1.19920865e-01,-7.57296160e-02,-1.43757403e-01,-9.37972800e-04],
[-2.87859961e-02,5.73301539e-02,-5.68089843e-01,-1.18526950e-01,-8.22766721e-02,-6.27147108e-02,2.23585606e-01,-4.24335785e-02],
[-7.63111189e-02,-4.89890069e-01,-1.05926967e+00,7.22521245e-01, 9.81056839e-02,1.37080818e-01,5.94312847e-02,-1.96360677e-01]],

[[1.04818299e-01,-8.67192209e-01,-2.39924744e-01,-7.85480618e-01, -7.74442777e-02,4.40404773e-01,2.93581616e-02,-2.56080106e-02],
[2.68763721e-01,-6.28690660e-01,-1.19581616e+00,-3.85673255e-01, -7.73591101e-02,3.90824974e-01,3.03063095e-01,-2.94098514e-03],
[2.45177448e-01,-1.40299463e+00,-1.84703982e+00,6.21656895e-01, -2.28439376e-01,7.64792621e-01,3.39021862e-01,-1.74401417e-01]]],


[[[-2.51690745e-01,5.51090896e-01,5.00423074e-01,-1.19021777e-02, -1.53560877e-01,-6.91351652e-01,4.18347359e-01,-1.20992161e-01],
[1.01641789e-01,6.30180478e-01,-3.06701541e-01,2.39744455e-01, -1.51614651e-01,-3.93115550e-01,2.36216918e-01,4.33663875e-02],
[8.05773214e-03,4.18087006e-01,-3.62431526e-01,8.90605807e-01,-1.78063333e-01,4.46580470e-01,-2.25982398e-01,-2.24541500e-01]],

[[-2.09800959e-01,1.50008038e-01,-1.21011063e-01,-2.78189659e-01, 3.32088233e-03,-4.08751696e-01,-1.55535921e-01,-2.90668726e-01],
[-2.54640043e-01,3.69199246e-01,-7.99475431e-01,1.04216374e-01, -1.22463711e-01,-4.60744768e-01,-1.82713121e-01,-2.90774833e-02],
[-2.94080675e-01,6.99799210e-02,-8.74268830e-01,6.97163105e-01, -1.09775729e-01,2.05241054e-01,-2.79714435e-01,3.99667071e-03]],

[[-5.46402693e-01,4.32468086e-01,6.50319576e-01,-1.42037496e-01, 1.11612760e-01,1.16612978e-01,-6.05426822e-03,-7.34203635e-03],
[-3.17292213e-01,4.92139518e-01,2.51644731e-01,-1.53314739e-01,7.07492828e-02,3.77735496e-01,2.01444715e-01,-4.10608985e-02],
[-1.84768260e-01,-4.80028009e-03,-2.98144501e-02,4.17521864e-01, -1.64009035e-01,7.53757596e-01,-1.07808448e-01,-1.87372595e-01]],

[[-5.24428546e-01,-6.38676286e-01,5.43634653e-01,-5.61416984e-01, -2.15916961e-01,8.11923444e-01,1.27431406e-02,-4.08656299e-02],
[-1.42250940e-01,-3.07354718e-01,1.30830735e-01,-3.89745623e-01,5.92988431e-02,8.69492888e-01,4.26647991e-01,8.72765183e-02],
[-8.98616537e-02,-1.27732527e+00,-1.31768987e-01,1.86611190e-01, -2.51183398e-02,8.14064264e-01,2.10096672e-01,3.72478273e-03]]],


[[[-1.11968112e+00,7.67770648e-01,2.97936141e-01,1.53100282e-01, -1.29497498e-01,-6.49056554e-01,4.46334779e-01,-2.63092488e-01],
[-8.05672586e-01,5.84507763e-01,-8.41545999e-01,3.63259107e-01, -1.00540765e-01,-5.22446930e-01,3.38432431e-01,-9.83649641e-02],
[-9.73388433e-01,5.23423731e-01,-7.39011288e-01,8.14702749e-01, -1.82627171e-01,-1.31922001e-02,-2.38610178e-01,-3.60192619e-02]],

[[-1.09167838e+00,3.89746517e-01,1.79034239e-03,-4.19662222e-02, -1.68909002e-02,-6.69209123e-01,1.78306505e-01,-2.36696023e-02],
[-5.05041897e-01,1.15131982e-01,-5.48061371e-01,-1.34314299e-01, -2.31233940e-01,-7.70376325e-01,1.69020868e-03,-2.13060036e-01],
[-3.80664080e-01,-2.12461323e-01,-9.41284776e-01,3.77010137e-01,2.48182677e-02,-1.76255658e-01,-3.41020793e-01,-1.64468810e-01]],

[[-7.21985340e-01,2.81345814e-01,4.93246108e-01,-4.00672585e-01, -1.57101944e-01,6.00279383e-02,1.42639890e-01,-1.64408609e-01],
[-4.86298501e-01,3.95268559e-01,2.42751524e-01,-4.61415112e-01,9.43676159e-02,-1.83143824e-01,2.12920606e-01,3.33561152e-02],
[-2.05555469e-01,1.40213490e-01,-1.19689092e-01,2.17164963e-01, -2.07377508e-01,9.96942222e-02,-2.99952537e-01,-1.70233890e-01]],

[[-9.94342625e-01,-3.10313195e-01,3.19228232e-01,-6.39531195e-01,1.02447294e-01,3.21837455e-01,2.86138922e-01,-1.17541179e-01],
[-6.08241379e-01,-2.16338992e-01,-3.19818497e-01,-7.04940975e-01,8.58791471e-02,2.76686698e-01,4.90631282e-01,-2.96055321e-02],
[-3.72854233e-01,-8.00334036e-01,-5.66466868e-01,-1.20188333e-01, -2.44724870e-01,5.95972121e-01,1.36968672e-01,-2.30812743e-01]]]]
W1=np.array(W1)
print(W1.shape)
W2=[[[[ -8.61808181e-01,-1.19061017e+00, 3.64527524e-01,-8.80298793e-01
, -1.62419498e-01, 4.48218733e-01, 8.25391173e-01, 9.91238713e-01
,7.17357397e-01,-4.35259223e-01,-5.81732452e-01,-6.51975095e-01
,5.71977794e-01, 2.32371658e-01, 3.59221756e-01, 9.84268859e-02]
, [1.27614826e-01,-9.59482253e-01, 9.41055357e-01, 1.11503053e+00
, -4.35663283e-01, 4.06190842e-01, 4.84734885e-02,-3.37532669e-01
, -8.83266330e-01, 3.90076220e-01,-7.69906461e-01,-1.24815989e+00
, -2.15982571e-01,-5.37067294e-01,-8.18558782e-03, 4.66008149e-02]
, [6.36166513e-01, 1.40123034e+00,-4.71146405e-02, 6.51726365e-01
, -1.88184157e-01,-1.10550535e+00,-1.48736045e-01, 1.03532624e+00
,1.23176269e-01, 7.74088562e-01,-7.62537569e-02,-1.00849557e+00
,1.91816866e+00, 1.86035395e-01, 4.36258391e-02,-2.55964971e+00]
, [ -3.99968773e-02,-1.33539307e+00,-2.28760585e-01,-1.90238309e+00
,1.42819151e-01,-3.20863008e-01,-1.02544256e-01,-3.49311858e-01
,1.55573979e-01, 5.21109045e-01, 4.90696818e-01, 8.37506890e-01
, -1.42346337e-01,-1.46545875e+00, 1.14631677e+00,-5.43087184e-01]
, [2.55414218e-01,-2.89678484e-01, 1.50522992e-01,-1.02115802e-01
, -8.44753087e-02,-2.64554679e-01, 2.42595538e-01,-2.39785518e-02
,1.91539317e-01, 1.00906007e-01, 7.14807808e-02,-1.01527013e-01
, -7.22663030e-02, 1.38483241e-01, 6.28444999e-02,-1.18860893e-01]
, [ -2.25142479e-01,-1.36644232e+00,-1.69475818e+00, 1.04753636e-01
, -6.72179222e-01, 1.07680410e-01,-1.12518930e+00,-2.17187271e-01
,7.95753479e-01,-1.67248130e-01,-6.14785075e-01, 5.39078414e-01
, -1.17172211e-01, 3.54422778e-01,-5.94630167e-02, 3.18047941e-01]
, [ -2.09499717e-01,-6.89629093e-02,-2.62508273e-01, 4.06406559e-02
, -5.21220326e-01,-5.40589750e-01, 6.07890896e-02, 3.78312439e-01
, -4.37850773e-01, 8.62603724e-01, 5.17322600e-01, 1.14183135e-01
, -5.01878738e-01,-1.36642426e-01, 6.66057765e-02,-9.73715425e-01]
, [ -1.67762697e-01, 1.29977569e-01, 6.12525456e-02, 2.27530580e-02
,5.42087555e-02,-3.19601260e-02,-4.98504564e-02,-1.86390162e-01
,2.53294319e-01,-1.53784037e-01, 4.39020135e-02, 6.15496822e-02
,2.30506390e-01, 1.90777481e-02, 5.62089235e-02, 1.15724795e-01]]

,[[4.39936727e-01,-9.01031494e-03,-1.84527114e-01, 6.10630512e-02
,4.68295991e-01, 8.55368674e-02,-3.57731283e-01,-1.81914359e-01
,6.25665367e-01,-1.42122519e+00, 3.68562788e-02,-3.21445465e-01
, -2.32347772e-01,-3.45100552e-01,-6.50442421e-01, 2.13786021e-01]
, [7.24334836e-01,-6.45938158e-01, 1.33392775e+00, 1.22320950e-01
, -1.75419366e+00, 4.83899295e-01,-2.87692010e-01, 9.33295310e-01
, -2.99080253e-01,-1.74835831e-01,-6.32685721e-01,-5.25660396e-01
,5.67017257e-01, 3.53625685e-01, 3.89838696e-01,-9.00352374e-02]
, [ -1.12535965e+00, 4.50227648e-01,-1.00793600e-01, 1.07498549e-01
,1.60622287e+00,-3.73521745e-01, 1.73517108e-01,-2.16989696e-01
, -2.59353071e-01, 3.84205431e-01, 6.84373498e-01,-1.46928298e+00
,1.14203012e+00, 8.31685364e-01, 2.59960860e-01, 1.98180363e-01]
, [9.67658401e-01,-8.51738930e-01,-1.60309315e+00, 2.79391468e-01
, -5.35293102e-01, 2.17812136e-01, 1.87156156e-01, 3.26621443e-01
, -1.87092215e-01,-1.27405226e+00, 1.45333305e-01, 8.21905911e-01
, -1.52528381e+00, 3.75056893e-01,-2.64203131e-01,-8.55041981e-01]
, [ -2.13881165e-01,-5.75805493e-02, 6.78452104e-02,-1.94895267e-01
, -4.25421521e-02, 2.73414310e-02, 1.57313436e-01, 1.27426922e-01
, -1.13662571e-01, 7.83141553e-02,-3.01176637e-01, 7.53298402e-02
, -1.66951120e-01,-1.44330323e-01, 7.35970289e-02, 2.68015236e-01]
, [ -4.92698252e-02,-7.73487389e-01,-2.01178932e+00, 1.01302171e+00
,6.83281064e-01, 5.52004576e-01,-1.60070539e+00, 5.84729612e-01
,3.76882628e-02,-7.14338422e-01,-2.17612274e-02,-3.00919265e-01
, -1.47070706e-01,-1.27015245e+00,-1.65034783e+00, 2.19691247e-01]
, [3.59807253e-01, 4.85000193e-01, 2.92348027e-01, 2.67474651e-01
,1.26254410e-02,-1.48777068e-01,-3.09558392e-01,-1.17408922e-02
, -9.44827914e-01, 4.32973891e-01, 2.34482184e-01, 3.01952399e-02
, -2.01915383e-01, 4.23790425e-01,-5.40986657e-01, 6.71176910e-01]
, [ -5.89827858e-02, 1.34501368e-01, 1.06905937e-01, 6.58854693e-02
,2.31930673e-01,-1.25607684e-01, 1.50666192e-01,-1.87134333e-02
, -1.29727662e-01,-6.33678511e-02,-1.24641750e-02,-7.47204153e-03
,1.45236447e-01, 5.70215611e-03, 4.62163873e-02,-6.89890757e-02]]],


 [[[ -5.94673343e-02,-9.23588097e-01,-2.46385023e-01,-4.19843346e-01
,7.59367794e-02, 5.53875864e-01,-1.56979054e-01,-9.49145615e-01
, -1.26786143e-01,-1.24263239e+00, 8.33892345e-01,-3.87260467e-01
, -5.27066588e-02, 9.56935108e-01, 4.51424345e-02,-2.62183428e-01]
, [ -4.08485672e-03, 2.66799927e-01, 1.86582685e-01, 1.08199902e-01
, -4.44595516e-01, 7.47903824e-01, 1.46808255e+00,-1.26312226e-01
,4.91802275e-01,-1.32863021e+00,-1.31908250e+00,-1.06445158e+00
,2.12282628e-01, 2.11786017e-01,-5.25147974e-01, 5.81694245e-01]
, [ -1.60072833e-01, 9.41142261e-01, 6.07417822e-01, 1.85714975e-01
, -9.45729434e-01, 8.16541612e-01, 1.60236090e-01,-1.34904695e+00
,3.20532918e-01,-5.72208539e-02,-1.09056365e+00,-8.99511483e-03
,7.30765611e-03,-2.89694041e-01,-3.47572267e-01, 6.26470447e-01]
, [ -5.82238793e-01, 6.20153956e-02,-7.55510926e-02,-1.94132552e-01
, -2.88463145e-01, 9.06130672e-01,-2.12320000e-01,-5.43370917e-02
, -4.86311674e-01,-4.20918465e-01,-1.27907529e-01, 3.65250468e-01
, -1.95560930e-03,-1.02725172e+00, 8.21829081e-01, 6.52748883e-01]
, [2.48256505e-01,-7.22953975e-02, 8.00619498e-02, 7.37857968e-02
, -1.89888760e-01,-3.44732463e-01,-2.03300968e-01,-1.38239011e-01
, -1.94332078e-02,-9.81976092e-02,-2.59273350e-02,-2.44599089e-01
,4.63932343e-02,-6.68860450e-02,-5.32605313e-02,-5.75568527e-02]
, [4.01400000e-01,-6.68030620e-01,-8.13483238e-01,-7.41848826e-01
,7.13245094e-01,-1.69709325e-01, 6.44964874e-01,-5.58773398e-01
,6.20819271e-01,-2.15972567e+00, 3.39238703e-01,-2.86571495e-02
,6.79312289e-01,-1.32413745e+00,-2.00801626e-01, 4.41628993e-01]
, [2.36606468e-02, 1.89063638e-01, 4.19568092e-01,-1.24660499e-01
, -7.12112248e-01,-7.96685100e-01,-1.38602510e-01,-2.08210349e+00
, -2.71580095e-04,-2.04051107e-01, 1.83012307e-01, 8.63222480e-02
, -2.81461060e-01,-2.19340682e-01, 2.20733300e-01, 2.30880037e-01]
, [1.60134032e-01,-2.40556389e-01,-1.84123203e-01, 1.21323593e-01
,2.80281961e-01, 1.50953472e-01, 5.08055687e-02,-8.53725523e-03
, -1.70565620e-02,-1.23001166e-01,-2.06225649e-01,-3.21148396e-01
, -1.80304676e-01,-1.94945931e-02, 3.91002297e-02,-2.59245723e-01]]

,[[6.87978342e-02,-1.51660830e-01,-9.49475825e-01, 5.31820834e-01
, -2.39291698e-01,-1.09348603e-01,-3.64893913e-01, 9.48938727e-01
,5.34806907e-01,-8.74147534e-01, 3.47254664e-01,-9.04852748e-01
,3.52744639e-01, 8.48575175e-01,-3.46086562e-01,-1.01372957e-01]
, [5.19737422e-01, 1.29883468e-01, 2.57702738e-01,-2.03333318e-01
, -7.68536747e-01,-2.96494544e-01, 8.35228384e-01,-6.52281940e-01
,6.61951303e-02,-1.74212170e+00,-2.39085126e+00,-2.64003932e-01
,9.34061050e-01,-2.67783225e-01, 6.39889121e-01, 6.41912296e-02]
, [4.13412631e-01, 1.26955664e+00, 8.55572045e-01,-1.73708558e+00
,2.47655824e-01,-4.76609528e-01,-9.65959966e-01,-3.14114094e-01
,4.42176223e-01,-1.87846392e-01,-2.38340884e-01, 7.95624971e-01
, -3.88797075e-01, 5.84761024e-01, 1.01357412e+00, 9.22847927e-01]
, [2.74438441e-01, 1.63453639e-01,-6.28010109e-02,-1.55493036e-01
,2.34354064e-01, 2.87267596e-01, 1.83393344e-01, 1.57332435e-01
, -9.87744108e-02, 2.34410077e-01,-8.38563859e-01, 7.62698799e-02
, -6.08539820e-01,-1.98293999e-01,-5.80387771e-01, 2.28838146e-01]
, [ -6.79263920e-02,-2.57380188e-01, 1.25645339e-01, 5.85990548e-02
,2.23907128e-01, 5.87607659e-02,-1.55475825e-01, 1.00408264e-01
,1.95965528e-01, 1.54880300e-01, 1.04408458e-01, 2.36145705e-01
, -4.38647158e-02, 1.27922758e-01, 2.86127757e-02, 2.28121370e-01]
, [ -5.10096192e-01,-4.46217023e-02, 1.43505991e-01,-2.91546225e-03
,1.03541970e+00,-8.41564238e-02, 4.97914851e-01,-3.89904343e-02
,3.66505861e-01, 3.39795262e-01,-9.16168243e-02, 3.80131632e-01
,6.26985669e-01,-1.72348738e-01,-1.41680300e+00, 3.31195295e-01]
, [ -3.96574169e-01,-4.05054212e-01, 3.49445492e-01, 1.16670262e-02
,6.90214396e-01, 1.04727171e-01, 3.00757378e-01,-7.72663593e-01
,5.47048390e-01, 3.53181690e-01,-7.45512452e-03,-2.14005753e-01
, -5.51288784e-01,-2.53704309e-01,-4.76955265e-01,-1.51989564e-01]
, [2.34097749e-01,-6.78294450e-02,-3.27925265e-01,-1.09963931e-01
,8.28998908e-03, 1.95834503e-01, 3.56841832e-01,-1.37438074e-01
, -1.48640275e-01,-2.12186784e-01, 2.79743075e-01,-1.66865796e-01
, -1.25705838e-01,-1.56174242e-01, 1.19075447e-01, 1.16313174e-01]]]]
W2=np.array(W2)
print(W2.shape)
parameters={"W1":W1,"W2":W2}
def prediction():
	X_val=tf.placeholder(tf.float32,[None,75*75])
	X=tf.reshape(X_val, [-1, 75, 75, 3])
	Z3=forward_propagation(X,parameters)
	
	init=tf.global_variables_initializer()
	with tf.Session() as sess:
		sess.run(init)
		for i in range(1,55):
					path = "C:/Users/AK/Desktop/Tensorflow/dataset/test/"+"set"+str(i)+".jpg"
					image=np.array(ndimage.imread(path,flatten=False))
					if image.shape[2]>3:
						image = cv2.cvtColor(image, cv2.COLOR_BGRA2BGR)
					X_test=scipy.misc.imresize(image,size=(75,75)).reshape(1,75*75*3)
					X_test=X_test/255
					convert=np.reshape(X_test,(1,75,75,3))
					prediction=tf.argmax(Z3,1)
					value=sess.run(prediction,feed_dict={X:convert})
					print(value)
					plt.imshow(image)
					plt.show()
# tf.reset_default_graph()		
# prediction()